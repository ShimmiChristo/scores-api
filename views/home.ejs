<html>
    <head>
        <!-- <script src="./scoresScraper.js"></script> -->
        <link rel="stylesheet" type="text/css" href="./css/style.css" />
    </head>
    <body>

        <nav>
            <ul>
                <li><a href="/">Home</a></li>
                <li><a href="/scores">Scores</a></li>
                <li><a href="/about">About</a></li>
            </ul>
        </nav>
        <div class="search-container">
            <h1>NCAA API Search</h1>
                <div class="search-bar">
                    <input type="text" id="myInput" placeholder="Search for Games" title="Type in a name">
                </div>
                <div class="search-results">
                    <ul class="list">
                        <li class='date'>  </li>
                        <li class='loser'>  </li>
                        <li class='losingScore'>  </li>
                        <li class='round'>  </li>
                        <li class='winner'>  </li>
                        <li class='winningScore'>  </li>
                    </ul>
                </div>

        </div>

        <script>
            const ncaaAPI = "https://squares.chrisshimmin.com/api/ncaa";
            const ncaaArr = [];
            // let error = Object.assign({}, json, {
            //     status: response.status,
            //     statusText: response.statusText
            // })
            // return Promise.reject(error);
            fetch(ncaaAPI)
            // fetch('https://api.github.com/users/chrissycoyier/repos')
                 .then(handleResponse)
                //  .then(data => console.log(data[0], data[1], data[2], data[3], data[4], data[5]))
                 .then(data => ncaaArr.push(...data[0], ...data[1], ...data[2], ...data[3], ...data[4], ...data[5]))
                 .catch (error => console.log(error))



                 function handleResponse(response) {
                    let contentType = response.headers.get('content-type')
                    if (contentType.includes('application/json')) {
                        return handleJSONResponse(response);
                    }
                    else {
                        throw new Error(`Sorry, content-type ${contentType} not supported`);
                    }
                 }
                 function handleJSONResponse(response) {
                    return response.json()
                    .then(json => {
                        if (response.ok) {
                            return json
                        }
                        else {
                            return Promise.reject (Object.assign({}, json, {
                                status: response.status,
                                statusText: response.statusText
                            }))
                        }
                    })
                 }
           


            function searchResults(searchWord, arr) {
                // const searchWord = this.value;
                    return (arr.filter(info => {
                        const regex = new RegExp(searchWord, 'gi');
                        return (info.winner.match(regex));
                    }))
            }

            function displayResults() {
                const searchWord = searchResults(this.value, ncaaArr);   
                const list = document.querySelector('.list');
                // console.log(searchWord);
                console.log(document.querySelector('.list li'));
                const html = searchWord.forEach(element => {
                    console.log(element);
                    // for (i = 0; i < searchWord.length; i++) {
                        // console.log(searchWord[i]);
                        
                        // }
                    
                });
                list.innerHTML = html;
                
            }

            const searchBox = document.getElementById('myInput')

            searchBox.addEventListener('keyup', displayResults);
                
        </script>

       
    </body>
</html>